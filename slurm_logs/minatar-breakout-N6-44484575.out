Job:  minatar-breakout-N6 (44484575)
Node: holygpu8a15403.rc.fas.harvard.edu
GPUs: 0
Cores per task: 2
Python path updated:
sys.path includes: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax
PYTHONPATH env var: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax:
Config: env_name='minatar-breakout' seed=0 lr=0.0003 num_envs=4096 num_eval_envs=100 num_steps=128 plan_horizon=6 total_timesteps=500000000 frame_skip=1 update_epochs=3 minibatch_size=4096 gamma=0.99 gae_lambda=0.95 clip_eps=0.2 ent_coef=0.01 vf_coef=0.5 max_grad_norm=0.5 wandb_project='pgx-minatar-ppo' save_model=True gpu_id=0
Available JAX devices: [CudaDevice(id=0)]
Using device: cuda:0
Using custom Breakout env with frame skip
Starting training (Macro-PPO, AR head)...
{'sec': 0.0, 'minatar-breakout/eval_R': 0.4599999785423279, 'steps': 0}
{'sec': 0.8587231636047363, 'minatar-breakout/eval_R': 0.4899999797344208, 'steps': 3145728}
{'sec': 1.7162470817565918, 'minatar-breakout/eval_R': 0.6899999976158142, 'steps': 6291456}
{'sec': 2.5712592601776123, 'minatar-breakout/eval_R': 0.9799999594688416, 'steps': 9437184}
{'sec': 3.427957773208618, 'minatar-breakout/eval_R': 1.2200000286102295, 'steps': 12582912}
{'sec': 4.282767057418823, 'minatar-breakout/eval_R': 1.6399999856948853, 'steps': 15728640}
{'sec': 5.138578176498413, 'minatar-breakout/eval_R': 1.3700000047683716, 'steps': 18874368}
{'sec': 5.992768287658691, 'minatar-breakout/eval_R': 1.9399999380111694, 'steps': 22020096}
{'sec': 6.850489854812622, 'minatar-breakout/eval_R': 2.2100000381469727, 'steps': 25165824}
{'sec': 7.704692602157593, 'minatar-breakout/eval_R': 2.4700000286102295, 'steps': 28311552}
{'sec': 8.559811353683472, 'minatar-breakout/eval_R': 2.3499999046325684, 'steps': 31457280}
{'sec': 9.414568662643433, 'minatar-breakout/eval_R': 3.0299999713897705, 'steps': 34603008}
{'sec': 10.269227266311646, 'minatar-breakout/eval_R': 2.6399998664855957, 'steps': 37748736}
{'sec': 11.124133110046387, 'minatar-breakout/eval_R': 3.3899998664855957, 'steps': 40894464}
{'sec': 11.979088306427002, 'minatar-breakout/eval_R': 3.1399998664855957, 'steps': 44040192}
{'sec': 12.834103345870972, 'minatar-breakout/eval_R': 3.9800000190734863, 'steps': 47185920}
{'sec': 13.688416719436646, 'minatar-breakout/eval_R': 3.9599997997283936, 'steps': 50331648}
{'sec': 14.54329252243042, 'minatar-breakout/eval_R': 3.919999837875366, 'steps': 53477376}
{'sec': 15.40030288696289, 'minatar-breakout/eval_R': 4.460000038146973, 'steps': 56623104}
{'sec': 16.2552330493927, 'minatar-breakout/eval_R': 4.599999904632568, 'steps': 59768832}
{'sec': 17.109894275665283, 'minatar-breakout/eval_R': 5.130000114440918, 'steps': 62914560}
{'sec': 17.96575403213501, 'minatar-breakout/eval_R': 4.849999904632568, 'steps': 66060288}
{'sec': 18.820772886276245, 'minatar-breakout/eval_R': 6.759999752044678, 'steps': 69206016}
{'sec': 19.676443338394165, 'minatar-breakout/eval_R': 6.460000038146973, 'steps': 72351744}
{'sec': 20.532387018203735, 'minatar-breakout/eval_R': 5.940000057220459, 'steps': 75497472}
{'sec': 21.386980533599854, 'minatar-breakout/eval_R': 7.21999979019165, 'steps': 78643200}
{'sec': 22.2418212890625, 'minatar-breakout/eval_R': 8.569999694824219, 'steps': 81788928}
{'sec': 23.09670853614807, 'minatar-breakout/eval_R': 7.449999809265137, 'steps': 84934656}
{'sec': 23.952497243881226, 'minatar-breakout/eval_R': 8.649999618530273, 'steps': 88080384}
{'sec': 24.80790662765503, 'minatar-breakout/eval_R': 9.789999961853027, 'steps': 91226112}
{'sec': 25.663103342056274, 'minatar-breakout/eval_R': 10.519999504089355, 'steps': 94371840}
{'sec': 26.518855810165405, 'minatar-breakout/eval_R': 9.359999656677246, 'steps': 97517568}
{'sec': 27.37358021736145, 'minatar-breakout/eval_R': 10.59999942779541, 'steps': 100663296}
{'sec': 28.228336572647095, 'minatar-breakout/eval_R': 10.699999809265137, 'steps': 103809024}
{'sec': 29.083823204040527, 'minatar-breakout/eval_R': 9.699999809265137, 'steps': 106954752}
{'sec': 29.938857793807983, 'minatar-breakout/eval_R': 10.449999809265137, 'steps': 110100480}
{'sec': 30.794342756271362, 'minatar-breakout/eval_R': 10.420000076293945, 'steps': 113246208}
{'sec': 31.64976477622986, 'minatar-breakout/eval_R': 11.149999618530273, 'steps': 116391936}
{'sec': 32.50465154647827, 'minatar-breakout/eval_R': 13.239999771118164, 'steps': 119537664}
{'sec': 33.35981249809265, 'minatar-breakout/eval_R': 11.639999389648438, 'steps': 122683392}
{'sec': 34.21492028236389, 'minatar-breakout/eval_R': 14.4399995803833, 'steps': 125829120}
{'sec': 35.0701470375061, 'minatar-breakout/eval_R': 11.719999313354492, 'steps': 128974848}
{'sec': 35.92665696144104, 'minatar-breakout/eval_R': 15.289999961853027, 'steps': 132120576}
{'sec': 36.78158116340637, 'minatar-breakout/eval_R': 14.149999618530273, 'steps': 135266304}
{'sec': 37.636282205581665, 'minatar-breakout/eval_R': 15.019999504089355, 'steps': 138412032}
{'sec': 38.49248814582825, 'minatar-breakout/eval_R': 13.829999923706055, 'steps': 141557760}
{'sec': 39.34759736061096, 'minatar-breakout/eval_R': 15.069999694824219, 'steps': 144703488}
{'sec': 40.20256757736206, 'minatar-breakout/eval_R': 15.949999809265137, 'steps': 147849216}
{'sec': 41.05759882926941, 'minatar-breakout/eval_R': 14.84999942779541, 'steps': 150994944}
{'sec': 41.91470956802368, 'minatar-breakout/eval_R': 15.139999389648438, 'steps': 154140672}
{'sec': 42.770427227020264, 'minatar-breakout/eval_R': 17.219999313354492, 'steps': 157286400}
{'sec': 43.626240730285645, 'minatar-breakout/eval_R': 16.3799991607666, 'steps': 160432128}
{'sec': 44.48108673095703, 'minatar-breakout/eval_R': 16.81999969482422, 'steps': 163577856}
{'sec': 45.337031841278076, 'minatar-breakout/eval_R': 16.350000381469727, 'steps': 166723584}
{'sec': 46.19212031364441, 'minatar-breakout/eval_R': 15.679999351501465, 'steps': 169869312}
{'sec': 47.04738140106201, 'minatar-breakout/eval_R': 16.940000534057617, 'steps': 173015040}
{'sec': 47.902069330215454, 'minatar-breakout/eval_R': 15.149999618530273, 'steps': 176160768}
{'sec': 48.75752782821655, 'minatar-breakout/eval_R': 19.18000030517578, 'steps': 179306496}
{'sec': 49.61297392845154, 'minatar-breakout/eval_R': 17.299999237060547, 'steps': 182452224}
{'sec': 50.46797037124634, 'minatar-breakout/eval_R': 17.869998931884766, 'steps': 185597952}
{'sec': 51.3229660987854, 'minatar-breakout/eval_R': 18.25, 'steps': 188743680}
{'sec': 52.178130865097046, 'minatar-breakout/eval_R': 18.0, 'steps': 191889408}
{'sec': 53.032896280288696, 'minatar-breakout/eval_R': 18.69999885559082, 'steps': 195035136}
{'sec': 53.88782548904419, 'minatar-breakout/eval_R': 17.5, 'steps': 198180864}
{'sec': 54.742666482925415, 'minatar-breakout/eval_R': 17.69999885559082, 'steps': 201326592}
{'sec': 55.598010301589966, 'minatar-breakout/eval_R': 19.899999618530273, 'steps': 204472320}
{'sec': 56.45315361022949, 'minatar-breakout/eval_R': 19.170000076293945, 'steps': 207618048}
{'sec': 57.30784487724304, 'minatar-breakout/eval_R': 18.93000030517578, 'steps': 210763776}
{'sec': 58.16300177574158, 'minatar-breakout/eval_R': 20.93000030517578, 'steps': 213909504}
{'sec': 59.01871132850647, 'minatar-breakout/eval_R': 15.949999809265137, 'steps': 217055232}
{'sec': 59.87377882003784, 'minatar-breakout/eval_R': 18.979999542236328, 'steps': 220200960}
{'sec': 60.72965359687805, 'minatar-breakout/eval_R': 19.8799991607666, 'steps': 223346688}
{'sec': 61.58438539505005, 'minatar-breakout/eval_R': 16.440000534057617, 'steps': 226492416}
{'sec': 62.4402391910553, 'minatar-breakout/eval_R': 19.600000381469727, 'steps': 229638144}
{'sec': 63.295647859573364, 'minatar-breakout/eval_R': 18.579999923706055, 'steps': 232783872}
{'sec': 64.15154361724854, 'minatar-breakout/eval_R': 19.06999969482422, 'steps': 235929600}
{'sec': 65.00659036636353, 'minatar-breakout/eval_R': 21.559999465942383, 'steps': 239075328}
{'sec': 65.86283469200134, 'minatar-breakout/eval_R': 21.649999618530273, 'steps': 242221056}
{'sec': 66.71823382377625, 'minatar-breakout/eval_R': 20.90999984741211, 'steps': 245366784}
{'sec': 67.57433700561523, 'minatar-breakout/eval_R': 18.94999885559082, 'steps': 248512512}
{'sec': 68.43004393577576, 'minatar-breakout/eval_R': 21.520000457763672, 'steps': 251658240}
{'sec': 69.28567147254944, 'minatar-breakout/eval_R': 19.90999984741211, 'steps': 254803968}
{'sec': 70.14172291755676, 'minatar-breakout/eval_R': 23.8799991607666, 'steps': 257949696}
{'sec': 70.99735713005066, 'minatar-breakout/eval_R': 20.59000015258789, 'steps': 261095424}
{'sec': 71.85256361961365, 'minatar-breakout/eval_R': 22.69999885559082, 'steps': 264241152}
{'sec': 72.70746541023254, 'minatar-breakout/eval_R': 19.469999313354492, 'steps': 267386880}
{'sec': 73.56283736228943, 'minatar-breakout/eval_R': 21.15999984741211, 'steps': 270532608}
{'sec': 74.41794896125793, 'minatar-breakout/eval_R': 22.03999900817871, 'steps': 273678336}
{'sec': 75.27391028404236, 'minatar-breakout/eval_R': 23.65999984741211, 'steps': 276824064}
{'sec': 76.12979674339294, 'minatar-breakout/eval_R': 22.979999542236328, 'steps': 279969792}
{'sec': 76.98455595970154, 'minatar-breakout/eval_R': 22.5, 'steps': 283115520}
{'sec': 77.83970093727112, 'minatar-breakout/eval_R': 21.09000015258789, 'steps': 286261248}
{'sec': 78.69677472114563, 'minatar-breakout/eval_R': 19.939998626708984, 'steps': 289406976}
{'sec': 79.55194926261902, 'minatar-breakout/eval_R': 22.079999923706055, 'steps': 292552704}
{'sec': 80.40920543670654, 'minatar-breakout/eval_R': 23.68000030517578, 'steps': 295698432}
{'sec': 81.26403880119324, 'minatar-breakout/eval_R': 25.889999389648438, 'steps': 298844160}
{'sec': 82.11915612220764, 'minatar-breakout/eval_R': 20.619998931884766, 'steps': 301989888}
{'sec': 82.97429203987122, 'minatar-breakout/eval_R': 18.53999900817871, 'steps': 305135616}
{'sec': 83.82913899421692, 'minatar-breakout/eval_R': 23.399999618530273, 'steps': 308281344}
{'sec': 84.68389415740967, 'minatar-breakout/eval_R': 23.51999855041504, 'steps': 311427072}
{'sec': 85.53943610191345, 'minatar-breakout/eval_R': 18.440000534057617, 'steps': 314572800}
{'sec': 86.39566016197205, 'minatar-breakout/eval_R': 23.260000228881836, 'steps': 317718528}
{'sec': 87.25100898742676, 'minatar-breakout/eval_R': 22.149999618530273, 'steps': 320864256}
{'sec': 88.10742664337158, 'minatar-breakout/eval_R': 21.639999389648438, 'steps': 324009984}
{'sec': 88.96291017532349, 'minatar-breakout/eval_R': 23.65999984741211, 'steps': 327155712}
{'sec': 89.81794738769531, 'minatar-breakout/eval_R': 27.3799991607666, 'steps': 330301440}
{'sec': 90.67326998710632, 'minatar-breakout/eval_R': 23.399999618530273, 'steps': 333447168}
{'sec': 91.52784085273743, 'minatar-breakout/eval_R': 22.399999618530273, 'steps': 336592896}
{'sec': 92.38268041610718, 'minatar-breakout/eval_R': 24.1299991607666, 'steps': 339738624}
{'sec': 93.2380542755127, 'minatar-breakout/eval_R': 21.549999237060547, 'steps': 342884352}
{'sec': 94.09297847747803, 'minatar-breakout/eval_R': 25.399999618530273, 'steps': 346030080}
{'sec': 94.9484052658081, 'minatar-breakout/eval_R': 22.969999313354492, 'steps': 349175808}
{'sec': 95.8030776977539, 'minatar-breakout/eval_R': 20.81999969482422, 'steps': 352321536}
{'sec': 96.65791893005371, 'minatar-breakout/eval_R': 26.349998474121094, 'steps': 355467264}
{'sec': 97.51383209228516, 'minatar-breakout/eval_R': 23.209999084472656, 'steps': 358612992}
{'sec': 98.36874389648438, 'minatar-breakout/eval_R': 24.18000030517578, 'steps': 361758720}
{'sec': 99.22349143028259, 'minatar-breakout/eval_R': 27.399999618530273, 'steps': 364904448}
{'sec': 100.07893180847168, 'minatar-breakout/eval_R': 23.18000030517578, 'steps': 368050176}
{'sec': 100.9339451789856, 'minatar-breakout/eval_R': 24.989999771118164, 'steps': 371195904}
{'sec': 101.78888392448425, 'minatar-breakout/eval_R': 25.59000015258789, 'steps': 374341632}
{'sec': 102.64333319664001, 'minatar-breakout/eval_R': 25.51999855041504, 'steps': 377487360}
{'sec': 103.49840259552002, 'minatar-breakout/eval_R': 24.979999542236328, 'steps': 380633088}
{'sec': 104.35443019866943, 'minatar-breakout/eval_R': 23.399999618530273, 'steps': 383778816}
{'sec': 105.20919680595398, 'minatar-breakout/eval_R': 27.8799991607666, 'steps': 386924544}
{'sec': 106.06659936904907, 'minatar-breakout/eval_R': 27.81999969482422, 'steps': 390070272}
{'sec': 106.92228841781616, 'minatar-breakout/eval_R': 27.26999855041504, 'steps': 393216000}
{'sec': 107.77738428115845, 'minatar-breakout/eval_R': 29.920000076293945, 'steps': 396361728}
{'sec': 108.6324348449707, 'minatar-breakout/eval_R': 25.219999313354492, 'steps': 399507456}
{'sec': 109.4876127243042, 'minatar-breakout/eval_R': 24.329999923706055, 'steps': 402653184}
{'sec': 110.34250497817993, 'minatar-breakout/eval_R': 28.60999870300293, 'steps': 405798912}
{'sec': 111.19893026351929, 'minatar-breakout/eval_R': 24.229999542236328, 'steps': 408944640}
{'sec': 112.0536105632782, 'minatar-breakout/eval_R': 30.209999084472656, 'steps': 412090368}
{'sec': 112.90961694717407, 'minatar-breakout/eval_R': 31.26999855041504, 'steps': 415236096}
{'sec': 113.76437973976135, 'minatar-breakout/eval_R': 23.459999084472656, 'steps': 418381824}
{'sec': 114.62053656578064, 'minatar-breakout/eval_R': 27.979999542236328, 'steps': 421527552}
{'sec': 115.47707724571228, 'minatar-breakout/eval_R': 25.670000076293945, 'steps': 424673280}
{'sec': 116.33271861076355, 'minatar-breakout/eval_R': 25.8799991607666, 'steps': 427819008}
{'sec': 117.1886420249939, 'minatar-breakout/eval_R': 23.25, 'steps': 430964736}
{'sec': 118.04409337043762, 'minatar-breakout/eval_R': 24.60999870300293, 'steps': 434110464}
{'sec': 118.8987398147583, 'minatar-breakout/eval_R': 26.369998931884766, 'steps': 437256192}
{'sec': 119.7554121017456, 'minatar-breakout/eval_R': 25.229999542236328, 'steps': 440401920}
{'sec': 120.61038827896118, 'minatar-breakout/eval_R': 27.010000228881836, 'steps': 443547648}
{'sec': 121.46478509902954, 'minatar-breakout/eval_R': 28.760000228881836, 'steps': 446693376}
{'sec': 122.32011389732361, 'minatar-breakout/eval_R': 29.469999313354492, 'steps': 449839104}
{'sec': 123.17492985725403, 'minatar-breakout/eval_R': 30.06999969482422, 'steps': 452984832}
{'sec': 124.0304548740387, 'minatar-breakout/eval_R': 27.299999237060547, 'steps': 456130560}
{'sec': 124.88580203056335, 'minatar-breakout/eval_R': 27.010000228881836, 'steps': 459276288}
{'sec': 125.74102997779846, 'minatar-breakout/eval_R': 26.099998474121094, 'steps': 462422016}
{'sec': 126.59584832191467, 'minatar-breakout/eval_R': 26.760000228881836, 'steps': 465567744}
{'sec': 127.45077395439148, 'minatar-breakout/eval_R': 30.279998779296875, 'steps': 468713472}
{'sec': 128.3058135509491, 'minatar-breakout/eval_R': 22.899999618530273, 'steps': 471859200}
{'sec': 129.16092085838318, 'minatar-breakout/eval_R': 24.43000030517578, 'steps': 475004928}
{'sec': 130.0164086818695, 'minatar-breakout/eval_R': 27.6299991607666, 'steps': 478150656}
{'sec': 130.87095832824707, 'minatar-breakout/eval_R': 28.60999870300293, 'steps': 481296384}
{'sec': 131.72739791870117, 'minatar-breakout/eval_R': 26.299999237060547, 'steps': 484442112}
{'sec': 132.58350086212158, 'minatar-breakout/eval_R': 24.149999618530273, 'steps': 487587840}
{'sec': 133.43923258781433, 'minatar-breakout/eval_R': 31.599998474121094, 'steps': 490733568}
{'sec': 134.2966411113739, 'minatar-breakout/eval_R': 31.510000228881836, 'steps': 493879296}
{'sec': 135.1516900062561, 'minatar-breakout/eval_R': 25.529998779296875, 'steps': 497025024}
Model saved to ./minatar-ppo-autoregressive-models/minatar-breakout//minatar-breakout-autoregressive-fs=1-N=6.ckpt
Training complete!
