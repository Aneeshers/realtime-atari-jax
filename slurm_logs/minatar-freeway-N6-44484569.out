Job:  minatar-freeway-N6 (44484569)
Node: holygpu8a13101.rc.fas.harvard.edu
GPUs: 0
Cores per task: 2
Python path updated:
sys.path includes: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax
PYTHONPATH env var: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax:
Config: env_name='minatar-freeway' seed=0 lr=0.0003 num_envs=4096 num_eval_envs=100 num_steps=128 plan_horizon=6 total_timesteps=500000000 frame_skip=1 update_epochs=3 minibatch_size=4096 gamma=0.99 gae_lambda=0.95 clip_eps=0.2 ent_coef=0.01 vf_coef=0.5 max_grad_norm=0.5 wandb_project='pgx-minatar-ppo' save_model=True gpu_id=0
Available JAX devices: [CudaDevice(id=0)]
Using device: cuda:0
Using custom Freeway env with frame skip
Starting training (Macro-PPO, AR head)...
{'sec': 0.0, 'minatar-freeway/eval_R': 1.3600000143051147, 'steps': 0}
{'sec': 1.0287327766418457, 'minatar-freeway/eval_R': 2.2699999809265137, 'steps': 3145728}
{'sec': 2.0510873794555664, 'minatar-freeway/eval_R': 3.2899999618530273, 'steps': 6291456}
{'sec': 3.07421612739563, 'minatar-freeway/eval_R': 4.690000057220459, 'steps': 9437184}
{'sec': 4.098261833190918, 'minatar-freeway/eval_R': 6.210000038146973, 'steps': 12582912}
{'sec': 5.1218085289001465, 'minatar-freeway/eval_R': 8.359999656677246, 'steps': 15728640}
{'sec': 6.144863128662109, 'minatar-freeway/eval_R': 9.760000228881836, 'steps': 18874368}
{'sec': 7.170681953430176, 'minatar-freeway/eval_R': 12.079999923706055, 'steps': 22020096}
{'sec': 8.19484543800354, 'minatar-freeway/eval_R': 14.389999389648438, 'steps': 25165824}
{'sec': 9.218788385391235, 'minatar-freeway/eval_R': 15.949999809265137, 'steps': 28311552}
{'sec': 10.24181079864502, 'minatar-freeway/eval_R': 18.15999984741211, 'steps': 31457280}
{'sec': 11.265614748001099, 'minatar-freeway/eval_R': 19.270000457763672, 'steps': 34603008}
{'sec': 12.289613008499146, 'minatar-freeway/eval_R': 20.809999465942383, 'steps': 37748736}
{'sec': 13.313863277435303, 'minatar-freeway/eval_R': 22.309999465942383, 'steps': 40894464}
{'sec': 14.336958169937134, 'minatar-freeway/eval_R': 24.01999855041504, 'steps': 44040192}
{'sec': 15.360607147216797, 'minatar-freeway/eval_R': 25.119998931884766, 'steps': 47185920}
{'sec': 16.3843731880188, 'minatar-freeway/eval_R': 26.579999923706055, 'steps': 50331648}
{'sec': 17.407676219940186, 'minatar-freeway/eval_R': 26.68000030517578, 'steps': 53477376}
{'sec': 18.431793689727783, 'minatar-freeway/eval_R': 29.049999237060547, 'steps': 56623104}
{'sec': 19.45729398727417, 'minatar-freeway/eval_R': 30.349998474121094, 'steps': 59768832}
{'sec': 20.482101440429688, 'minatar-freeway/eval_R': 31.799999237060547, 'steps': 62914560}
{'sec': 21.506877422332764, 'minatar-freeway/eval_R': 33.48999786376953, 'steps': 66060288}
{'sec': 22.530471324920654, 'minatar-freeway/eval_R': 33.939998626708984, 'steps': 69206016}
{'sec': 23.55402159690857, 'minatar-freeway/eval_R': 34.709999084472656, 'steps': 72351744}
{'sec': 24.576977491378784, 'minatar-freeway/eval_R': 35.459999084472656, 'steps': 75497472}
{'sec': 25.601482629776, 'minatar-freeway/eval_R': 36.38999938964844, 'steps': 78643200}
{'sec': 26.62501859664917, 'minatar-freeway/eval_R': 36.31999969482422, 'steps': 81788928}
{'sec': 27.64789867401123, 'minatar-freeway/eval_R': 38.54999923706055, 'steps': 84934656}
{'sec': 28.671080827713013, 'minatar-freeway/eval_R': 38.75, 'steps': 88080384}
{'sec': 29.695002555847168, 'minatar-freeway/eval_R': 39.98999786376953, 'steps': 91226112}
{'sec': 30.71800684928894, 'minatar-freeway/eval_R': 40.88999938964844, 'steps': 94371840}
{'sec': 31.741526126861572, 'minatar-freeway/eval_R': 41.29999923706055, 'steps': 97517568}
{'sec': 32.76458215713501, 'minatar-freeway/eval_R': 41.71999740600586, 'steps': 100663296}
{'sec': 33.78846859931946, 'minatar-freeway/eval_R': 41.90999984741211, 'steps': 103809024}
{'sec': 34.81204271316528, 'minatar-freeway/eval_R': 41.82999801635742, 'steps': 106954752}
{'sec': 35.83444094657898, 'minatar-freeway/eval_R': 43.689998626708984, 'steps': 110100480}
{'sec': 36.85760688781738, 'minatar-freeway/eval_R': 43.91999816894531, 'steps': 113246208}
{'sec': 37.88194036483765, 'minatar-freeway/eval_R': 43.64999771118164, 'steps': 116391936}
{'sec': 38.90604901313782, 'minatar-freeway/eval_R': 43.54999923706055, 'steps': 119537664}
{'sec': 39.92914652824402, 'minatar-freeway/eval_R': 45.13999938964844, 'steps': 122683392}
{'sec': 40.95348000526428, 'minatar-freeway/eval_R': 45.06999969482422, 'steps': 125829120}
{'sec': 41.9771044254303, 'minatar-freeway/eval_R': 45.349998474121094, 'steps': 128974848}
{'sec': 43.0009822845459, 'minatar-freeway/eval_R': 45.78999710083008, 'steps': 132120576}
{'sec': 44.024545431137085, 'minatar-freeway/eval_R': 46.41999816894531, 'steps': 135266304}
{'sec': 45.047057151794434, 'minatar-freeway/eval_R': 46.34000015258789, 'steps': 138412032}
{'sec': 46.07071304321289, 'minatar-freeway/eval_R': 46.84000015258789, 'steps': 141557760}
{'sec': 47.09431266784668, 'minatar-freeway/eval_R': 46.90999984741211, 'steps': 144703488}
{'sec': 48.11753296852112, 'minatar-freeway/eval_R': 48.39999771118164, 'steps': 147849216}
{'sec': 49.14175033569336, 'minatar-freeway/eval_R': 46.91999816894531, 'steps': 150994944}
{'sec': 50.165294885635376, 'minatar-freeway/eval_R': 48.82999801635742, 'steps': 154140672}
{'sec': 51.188088178634644, 'minatar-freeway/eval_R': 48.11000061035156, 'steps': 157286400}
{'sec': 52.21086359024048, 'minatar-freeway/eval_R': 47.87999725341797, 'steps': 160432128}
{'sec': 53.23529291152954, 'minatar-freeway/eval_R': 48.5099983215332, 'steps': 163577856}
{'sec': 54.25849366188049, 'minatar-freeway/eval_R': 49.16999816894531, 'steps': 166723584}
{'sec': 55.28326606750488, 'minatar-freeway/eval_R': 48.55999755859375, 'steps': 169869312}
{'sec': 56.30721569061279, 'minatar-freeway/eval_R': 49.5099983215332, 'steps': 173015040}
{'sec': 57.33003616333008, 'minatar-freeway/eval_R': 50.09000015258789, 'steps': 176160768}
{'sec': 58.35408139228821, 'minatar-freeway/eval_R': 50.20000076293945, 'steps': 179306496}
{'sec': 59.37746071815491, 'minatar-freeway/eval_R': 49.93000030517578, 'steps': 182452224}
{'sec': 60.40053939819336, 'minatar-freeway/eval_R': 49.59000015258789, 'steps': 185597952}
{'sec': 61.42360830307007, 'minatar-freeway/eval_R': 50.39999771118164, 'steps': 188743680}
{'sec': 62.44781136512756, 'minatar-freeway/eval_R': 49.88999938964844, 'steps': 191889408}
{'sec': 63.470266580581665, 'minatar-freeway/eval_R': 50.68000030517578, 'steps': 195035136}
{'sec': 64.49438214302063, 'minatar-freeway/eval_R': 50.41999816894531, 'steps': 198180864}
{'sec': 65.51853585243225, 'minatar-freeway/eval_R': 50.75, 'steps': 201326592}
{'sec': 66.54204964637756, 'minatar-freeway/eval_R': 51.36000061035156, 'steps': 204472320}
{'sec': 67.56565809249878, 'minatar-freeway/eval_R': 49.22999954223633, 'steps': 207618048}
{'sec': 68.58928298950195, 'minatar-freeway/eval_R': 50.959999084472656, 'steps': 210763776}
{'sec': 69.61285400390625, 'minatar-freeway/eval_R': 51.09000015258789, 'steps': 213909504}
{'sec': 70.63568878173828, 'minatar-freeway/eval_R': 51.099998474121094, 'steps': 217055232}
{'sec': 71.65982866287231, 'minatar-freeway/eval_R': 51.369998931884766, 'steps': 220200960}
{'sec': 72.68429040908813, 'minatar-freeway/eval_R': 51.89999771118164, 'steps': 223346688}
{'sec': 73.70784854888916, 'minatar-freeway/eval_R': 50.89999771118164, 'steps': 226492416}
{'sec': 74.73233389854431, 'minatar-freeway/eval_R': 51.78999710083008, 'steps': 229638144}
{'sec': 75.75625562667847, 'minatar-freeway/eval_R': 51.91999816894531, 'steps': 232783872}
{'sec': 76.77952218055725, 'minatar-freeway/eval_R': 52.25, 'steps': 235929600}
{'sec': 77.80343103408813, 'minatar-freeway/eval_R': 51.63999938964844, 'steps': 239075328}
{'sec': 78.82704997062683, 'minatar-freeway/eval_R': 52.84000015258789, 'steps': 242221056}
{'sec': 79.85159230232239, 'minatar-freeway/eval_R': 52.75, 'steps': 245366784}
{'sec': 80.87576961517334, 'minatar-freeway/eval_R': 52.099998474121094, 'steps': 248512512}
{'sec': 81.89884972572327, 'minatar-freeway/eval_R': 52.709999084472656, 'steps': 251658240}
{'sec': 82.92231369018555, 'minatar-freeway/eval_R': 52.28999710083008, 'steps': 254803968}
{'sec': 83.94520425796509, 'minatar-freeway/eval_R': 53.36000061035156, 'steps': 257949696}
{'sec': 84.96949744224548, 'minatar-freeway/eval_R': 52.81999969482422, 'steps': 261095424}
{'sec': 85.99379348754883, 'minatar-freeway/eval_R': 52.349998474121094, 'steps': 264241152}
{'sec': 87.01806473731995, 'minatar-freeway/eval_R': 52.689998626708984, 'steps': 267386880}
{'sec': 88.04134511947632, 'minatar-freeway/eval_R': 52.80999755859375, 'steps': 270532608}
{'sec': 89.06601238250732, 'minatar-freeway/eval_R': 53.54999923706055, 'steps': 273678336}
{'sec': 90.09040403366089, 'minatar-freeway/eval_R': 53.29999923706055, 'steps': 276824064}
{'sec': 91.11650037765503, 'minatar-freeway/eval_R': 53.59000015258789, 'steps': 279969792}
{'sec': 92.1409695148468, 'minatar-freeway/eval_R': 53.88999938964844, 'steps': 283115520}
{'sec': 93.16408205032349, 'minatar-freeway/eval_R': 54.31999969482422, 'steps': 286261248}
{'sec': 94.18843579292297, 'minatar-freeway/eval_R': 53.05999755859375, 'steps': 289406976}
{'sec': 95.21355628967285, 'minatar-freeway/eval_R': 54.19999694824219, 'steps': 292552704}
{'sec': 96.23637700080872, 'minatar-freeway/eval_R': 53.72999954223633, 'steps': 295698432}
{'sec': 97.26031064987183, 'minatar-freeway/eval_R': 53.87999725341797, 'steps': 298844160}
{'sec': 98.28318214416504, 'minatar-freeway/eval_R': 53.779998779296875, 'steps': 301989888}
{'sec': 99.30774712562561, 'minatar-freeway/eval_R': 53.599998474121094, 'steps': 305135616}
{'sec': 100.3319103717804, 'minatar-freeway/eval_R': 54.14999771118164, 'steps': 308281344}
{'sec': 101.35574555397034, 'minatar-freeway/eval_R': 54.34000015258789, 'steps': 311427072}
{'sec': 102.3803551197052, 'minatar-freeway/eval_R': 54.23999786376953, 'steps': 314572800}
{'sec': 103.40479016304016, 'minatar-freeway/eval_R': 53.939998626708984, 'steps': 317718528}
{'sec': 104.42767095565796, 'minatar-freeway/eval_R': 54.36000061035156, 'steps': 320864256}
{'sec': 105.4508695602417, 'minatar-freeway/eval_R': 54.84000015258789, 'steps': 324009984}
{'sec': 106.47540640830994, 'minatar-freeway/eval_R': 54.88999938964844, 'steps': 327155712}
{'sec': 107.50092029571533, 'minatar-freeway/eval_R': 55.28999710083008, 'steps': 330301440}
{'sec': 108.52571153640747, 'minatar-freeway/eval_R': 53.80999755859375, 'steps': 333447168}
{'sec': 109.54934787750244, 'minatar-freeway/eval_R': 55.03999710083008, 'steps': 336592896}
{'sec': 110.57291960716248, 'minatar-freeway/eval_R': 54.82999801635742, 'steps': 339738624}
{'sec': 111.5973265171051, 'minatar-freeway/eval_R': 55.40999984741211, 'steps': 342884352}
{'sec': 112.62117719650269, 'minatar-freeway/eval_R': 55.07999801635742, 'steps': 346030080}
{'sec': 113.64489603042603, 'minatar-freeway/eval_R': 54.98999786376953, 'steps': 349175808}
{'sec': 114.66967868804932, 'minatar-freeway/eval_R': 55.84000015258789, 'steps': 352321536}
{'sec': 115.69358253479004, 'minatar-freeway/eval_R': 54.52000045776367, 'steps': 355467264}
{'sec': 116.71751475334167, 'minatar-freeway/eval_R': 55.14999771118164, 'steps': 358612992}
{'sec': 117.74319434165955, 'minatar-freeway/eval_R': 54.71999740600586, 'steps': 361758720}
{'sec': 118.76684808731079, 'minatar-freeway/eval_R': 55.28999710083008, 'steps': 364904448}
{'sec': 119.79142928123474, 'minatar-freeway/eval_R': 55.90999984741211, 'steps': 368050176}
{'sec': 120.81627202033997, 'minatar-freeway/eval_R': 55.30999755859375, 'steps': 371195904}
{'sec': 121.8406252861023, 'minatar-freeway/eval_R': 55.81999969482422, 'steps': 374341632}
{'sec': 122.8639087677002, 'minatar-freeway/eval_R': 55.38999938964844, 'steps': 377487360}
{'sec': 123.88721704483032, 'minatar-freeway/eval_R': 55.43000030517578, 'steps': 380633088}
{'sec': 124.91127467155457, 'minatar-freeway/eval_R': 55.13999938964844, 'steps': 383778816}
{'sec': 125.93545389175415, 'minatar-freeway/eval_R': 55.65999984741211, 'steps': 386924544}
{'sec': 126.958575963974, 'minatar-freeway/eval_R': 54.47999954223633, 'steps': 390070272}
{'sec': 127.98292183876038, 'minatar-freeway/eval_R': 55.02000045776367, 'steps': 393216000}
{'sec': 129.0073471069336, 'minatar-freeway/eval_R': 55.62999725341797, 'steps': 396361728}
{'sec': 130.03115725517273, 'minatar-freeway/eval_R': 55.68000030517578, 'steps': 399507456}
{'sec': 131.05423641204834, 'minatar-freeway/eval_R': 55.69999694824219, 'steps': 402653184}
{'sec': 132.0781192779541, 'minatar-freeway/eval_R': 56.06999969482422, 'steps': 405798912}
{'sec': 133.10286474227905, 'minatar-freeway/eval_R': 55.71999740600586, 'steps': 408944640}
{'sec': 134.12768530845642, 'minatar-freeway/eval_R': 56.05999755859375, 'steps': 412090368}
{'sec': 135.1514720916748, 'minatar-freeway/eval_R': 56.31999969482422, 'steps': 415236096}
{'sec': 136.17555809020996, 'minatar-freeway/eval_R': 55.939998626708984, 'steps': 418381824}
{'sec': 137.19938850402832, 'minatar-freeway/eval_R': 55.82999801635742, 'steps': 421527552}
{'sec': 138.2237389087677, 'minatar-freeway/eval_R': 56.349998474121094, 'steps': 424673280}
{'sec': 139.24826455116272, 'minatar-freeway/eval_R': 56.43000030517578, 'steps': 427819008}
{'sec': 140.27248120307922, 'minatar-freeway/eval_R': 56.5099983215332, 'steps': 430964736}
{'sec': 141.297043800354, 'minatar-freeway/eval_R': 56.55999755859375, 'steps': 434110464}
{'sec': 142.32163858413696, 'minatar-freeway/eval_R': 56.69999694824219, 'steps': 437256192}
{'sec': 143.34441471099854, 'minatar-freeway/eval_R': 56.959999084472656, 'steps': 440401920}
{'sec': 144.36867427825928, 'minatar-freeway/eval_R': 56.849998474121094, 'steps': 443547648}
{'sec': 145.3929316997528, 'minatar-freeway/eval_R': 56.7599983215332, 'steps': 446693376}
{'sec': 146.41728806495667, 'minatar-freeway/eval_R': 56.52000045776367, 'steps': 449839104}
{'sec': 147.44143414497375, 'minatar-freeway/eval_R': 56.59000015258789, 'steps': 452984832}
{'sec': 148.4653582572937, 'minatar-freeway/eval_R': 56.53999710083008, 'steps': 456130560}
{'sec': 149.48896527290344, 'minatar-freeway/eval_R': 56.57999801635742, 'steps': 459276288}
{'sec': 150.51411533355713, 'minatar-freeway/eval_R': 57.0099983215332, 'steps': 462422016}
{'sec': 151.53823900222778, 'minatar-freeway/eval_R': 57.279998779296875, 'steps': 465567744}
{'sec': 152.56208682060242, 'minatar-freeway/eval_R': 56.36000061035156, 'steps': 468713472}
{'sec': 153.58587193489075, 'minatar-freeway/eval_R': 56.959999084472656, 'steps': 471859200}
{'sec': 154.61034107208252, 'minatar-freeway/eval_R': 57.19999694824219, 'steps': 475004928}
{'sec': 155.63408660888672, 'minatar-freeway/eval_R': 57.40999984741211, 'steps': 478150656}
{'sec': 156.65853714942932, 'minatar-freeway/eval_R': 57.27000045776367, 'steps': 481296384}
{'sec': 157.68216729164124, 'minatar-freeway/eval_R': 57.0099983215332, 'steps': 484442112}
{'sec': 158.70599961280823, 'minatar-freeway/eval_R': 57.71999740600586, 'steps': 487587840}
{'sec': 159.7293667793274, 'minatar-freeway/eval_R': 57.47999954223633, 'steps': 490733568}
{'sec': 160.7534739971161, 'minatar-freeway/eval_R': 57.02000045776367, 'steps': 493879296}
{'sec': 161.77855396270752, 'minatar-freeway/eval_R': 57.349998474121094, 'steps': 497025024}
Model saved to ./minatar-ppo-autoregressive-models/minatar-freeway//minatar-freeway-autoregressive-fs=1-N=6.ckpt
Training complete!
