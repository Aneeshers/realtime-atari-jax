Job:  minatar-freeway-N5 (44484568)
Node: holygpu8a11603.rc.fas.harvard.edu
GPUs: 0
Cores per task: 2
Python path updated:
sys.path includes: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax
PYTHONPATH env var: /home/ubuntu/tensorflow_test/control/real-timeRL/realtime-atari-jax:
Config: env_name='minatar-freeway' seed=0 lr=0.0003 num_envs=4096 num_eval_envs=100 num_steps=128 plan_horizon=5 total_timesteps=500000000 frame_skip=1 update_epochs=3 minibatch_size=4096 gamma=0.99 gae_lambda=0.95 clip_eps=0.2 ent_coef=0.01 vf_coef=0.5 max_grad_norm=0.5 wandb_project='pgx-minatar-ppo' save_model=True gpu_id=0
Available JAX devices: [CudaDevice(id=0)]
Using device: cuda:0
Using custom Freeway env with frame skip
Starting training (Macro-PPO, AR head)...
{'sec': 0.0, 'minatar-freeway/eval_R': 1.5699999332427979, 'steps': 0}
{'sec': 0.9101855754852295, 'minatar-freeway/eval_R': 2.419999837875366, 'steps': 2621440}
{'sec': 1.8180222511291504, 'minatar-freeway/eval_R': 3.4700000286102295, 'steps': 5242880}
{'sec': 2.7262022495269775, 'minatar-freeway/eval_R': 4.529999732971191, 'steps': 7864320}
{'sec': 3.6337618827819824, 'minatar-freeway/eval_R': 6.819999694824219, 'steps': 10485760}
{'sec': 4.541428565979004, 'minatar-freeway/eval_R': 8.15999984741211, 'steps': 13107200}
{'sec': 5.449135065078735, 'minatar-freeway/eval_R': 10.800000190734863, 'steps': 15728640}
{'sec': 6.357205152511597, 'minatar-freeway/eval_R': 13.109999656677246, 'steps': 18350080}
{'sec': 7.265195608139038, 'minatar-freeway/eval_R': 14.739999771118164, 'steps': 20971520}
{'sec': 8.171503782272339, 'minatar-freeway/eval_R': 17.440000534057617, 'steps': 23592960}
{'sec': 9.079399585723877, 'minatar-freeway/eval_R': 19.520000457763672, 'steps': 26214400}
{'sec': 9.987598896026611, 'minatar-freeway/eval_R': 20.689998626708984, 'steps': 28835840}
{'sec': 10.895151138305664, 'minatar-freeway/eval_R': 23.779998779296875, 'steps': 31457280}
{'sec': 11.804035902023315, 'minatar-freeway/eval_R': 24.28999900817871, 'steps': 34078720}
{'sec': 12.712766170501709, 'minatar-freeway/eval_R': 25.760000228881836, 'steps': 36700160}
{'sec': 13.620899438858032, 'minatar-freeway/eval_R': 26.829999923706055, 'steps': 39321600}
{'sec': 14.529368162155151, 'minatar-freeway/eval_R': 27.260000228881836, 'steps': 41943040}
{'sec': 15.436834812164307, 'minatar-freeway/eval_R': 29.60999870300293, 'steps': 44564480}
{'sec': 16.34448003768921, 'minatar-freeway/eval_R': 30.739999771118164, 'steps': 47185920}
{'sec': 17.25292205810547, 'minatar-freeway/eval_R': 32.61000061035156, 'steps': 49807360}
{'sec': 18.16109323501587, 'minatar-freeway/eval_R': 33.13999938964844, 'steps': 52428800}
{'sec': 19.068377256393433, 'minatar-freeway/eval_R': 33.869998931884766, 'steps': 55050240}
{'sec': 19.975974082946777, 'minatar-freeway/eval_R': 34.93000030517578, 'steps': 57671680}
{'sec': 20.884401082992554, 'minatar-freeway/eval_R': 35.209999084472656, 'steps': 60293120}
{'sec': 21.792476177215576, 'minatar-freeway/eval_R': 36.869998931884766, 'steps': 62914560}
{'sec': 22.700191020965576, 'minatar-freeway/eval_R': 37.47999954223633, 'steps': 65536000}
{'sec': 23.607990264892578, 'minatar-freeway/eval_R': 37.540000915527344, 'steps': 68157440}
{'sec': 24.516077756881714, 'minatar-freeway/eval_R': 38.80999755859375, 'steps': 70778880}
{'sec': 25.424530506134033, 'minatar-freeway/eval_R': 39.30999755859375, 'steps': 73400320}
{'sec': 26.332395315170288, 'minatar-freeway/eval_R': 41.52000045776367, 'steps': 76021760}
{'sec': 27.239951848983765, 'minatar-freeway/eval_R': 40.73999786376953, 'steps': 78643200}
{'sec': 28.148871183395386, 'minatar-freeway/eval_R': 42.89999771118164, 'steps': 81264640}
{'sec': 29.05729341506958, 'minatar-freeway/eval_R': 42.48999786376953, 'steps': 83886080}
{'sec': 29.964946746826172, 'minatar-freeway/eval_R': 42.89999771118164, 'steps': 86507520}
{'sec': 30.87259292602539, 'minatar-freeway/eval_R': 43.7599983215332, 'steps': 89128960}
{'sec': 31.781298875808716, 'minatar-freeway/eval_R': 44.43000030517578, 'steps': 91750400}
{'sec': 32.68850779533386, 'minatar-freeway/eval_R': 43.939998626708984, 'steps': 94371840}
{'sec': 33.595300912857056, 'minatar-freeway/eval_R': 44.75, 'steps': 96993280}
{'sec': 34.502687215805054, 'minatar-freeway/eval_R': 45.189998626708984, 'steps': 99614720}
{'sec': 35.411269426345825, 'minatar-freeway/eval_R': 45.53999710083008, 'steps': 102236160}
{'sec': 36.31891965866089, 'minatar-freeway/eval_R': 46.09000015258789, 'steps': 104857600}
{'sec': 37.22688055038452, 'minatar-freeway/eval_R': 47.65999984741211, 'steps': 107479040}
{'sec': 38.13554525375366, 'minatar-freeway/eval_R': 48.41999816894531, 'steps': 110100480}
{'sec': 39.044137716293335, 'minatar-freeway/eval_R': 47.90999984741211, 'steps': 112721920}
{'sec': 39.95091462135315, 'minatar-freeway/eval_R': 47.37999725341797, 'steps': 115343360}
{'sec': 40.85892105102539, 'minatar-freeway/eval_R': 47.75, 'steps': 117964800}
{'sec': 41.76654028892517, 'minatar-freeway/eval_R': 48.32999801635742, 'steps': 120586240}
{'sec': 42.67455697059631, 'minatar-freeway/eval_R': 48.84000015258789, 'steps': 123207680}
{'sec': 43.58153057098389, 'minatar-freeway/eval_R': 49.07999801635742, 'steps': 125829120}
{'sec': 44.49038004875183, 'minatar-freeway/eval_R': 49.82999801635742, 'steps': 128450560}
{'sec': 45.39690685272217, 'minatar-freeway/eval_R': 49.68000030517578, 'steps': 131072000}
{'sec': 46.30466365814209, 'minatar-freeway/eval_R': 49.68000030517578, 'steps': 133693440}
{'sec': 47.21166515350342, 'minatar-freeway/eval_R': 49.119998931884766, 'steps': 136314880}
{'sec': 48.119832038879395, 'minatar-freeway/eval_R': 50.52000045776367, 'steps': 138936320}
{'sec': 49.027116537094116, 'minatar-freeway/eval_R': 50.87999725341797, 'steps': 141557760}
{'sec': 49.9349467754364, 'minatar-freeway/eval_R': 51.0099983215332, 'steps': 144179200}
{'sec': 50.84180760383606, 'minatar-freeway/eval_R': 51.30999755859375, 'steps': 146800640}
{'sec': 51.749515771865845, 'minatar-freeway/eval_R': 52.11000061035156, 'steps': 149422080}
{'sec': 52.65850067138672, 'minatar-freeway/eval_R': 51.119998931884766, 'steps': 152043520}
{'sec': 53.56773495674133, 'minatar-freeway/eval_R': 51.48999786376953, 'steps': 154664960}
{'sec': 54.47566032409668, 'minatar-freeway/eval_R': 51.59000015258789, 'steps': 157286400}
{'sec': 55.382540702819824, 'minatar-freeway/eval_R': 51.709999084472656, 'steps': 159907840}
{'sec': 56.28999400138855, 'minatar-freeway/eval_R': 52.279998779296875, 'steps': 162529280}
{'sec': 57.19930362701416, 'minatar-freeway/eval_R': 52.16999816894531, 'steps': 165150720}
{'sec': 58.107186794281006, 'minatar-freeway/eval_R': 52.15999984741211, 'steps': 167772160}
{'sec': 59.01470136642456, 'minatar-freeway/eval_R': 52.53999710083008, 'steps': 170393600}
{'sec': 59.922173261642456, 'minatar-freeway/eval_R': 52.689998626708984, 'steps': 173015040}
{'sec': 60.83107233047485, 'minatar-freeway/eval_R': 52.369998931884766, 'steps': 175636480}
{'sec': 61.738116979599, 'minatar-freeway/eval_R': 52.71999740600586, 'steps': 178257920}
{'sec': 62.645578384399414, 'minatar-freeway/eval_R': 53.29999923706055, 'steps': 180879360}
{'sec': 63.55439901351929, 'minatar-freeway/eval_R': 53.72999954223633, 'steps': 183500800}
{'sec': 64.46301436424255, 'minatar-freeway/eval_R': 53.47999954223633, 'steps': 186122240}
{'sec': 65.37093687057495, 'minatar-freeway/eval_R': 53.25, 'steps': 188743680}
{'sec': 66.2778832912445, 'minatar-freeway/eval_R': 53.959999084472656, 'steps': 191365120}
{'sec': 67.185861825943, 'minatar-freeway/eval_R': 53.47999954223633, 'steps': 193986560}
{'sec': 68.09369707107544, 'minatar-freeway/eval_R': 53.55999755859375, 'steps': 196608000}
{'sec': 69.00149416923523, 'minatar-freeway/eval_R': 54.459999084472656, 'steps': 199229440}
{'sec': 69.91072130203247, 'minatar-freeway/eval_R': 54.27000045776367, 'steps': 201850880}
{'sec': 70.8180992603302, 'minatar-freeway/eval_R': 53.94999694824219, 'steps': 204472320}
{'sec': 71.72642040252686, 'minatar-freeway/eval_R': 54.43000030517578, 'steps': 207093760}
{'sec': 72.6344108581543, 'minatar-freeway/eval_R': 54.59000015258789, 'steps': 209715200}
{'sec': 73.54170179367065, 'minatar-freeway/eval_R': 55.0099983215332, 'steps': 212336640}
{'sec': 74.44990015029907, 'minatar-freeway/eval_R': 55.34000015258789, 'steps': 214958080}
{'sec': 75.35826086997986, 'minatar-freeway/eval_R': 55.41999816894531, 'steps': 217579520}
{'sec': 76.26656103134155, 'minatar-freeway/eval_R': 55.16999816894531, 'steps': 220200960}
{'sec': 77.17443346977234, 'minatar-freeway/eval_R': 54.56999969482422, 'steps': 222822400}
{'sec': 78.08183002471924, 'minatar-freeway/eval_R': 55.05999755859375, 'steps': 225443840}
{'sec': 78.99043488502502, 'minatar-freeway/eval_R': 55.689998626708984, 'steps': 228065280}
{'sec': 79.89849615097046, 'minatar-freeway/eval_R': 55.37999725341797, 'steps': 230686720}
{'sec': 80.80705690383911, 'minatar-freeway/eval_R': 55.75, 'steps': 233308160}
{'sec': 81.71425008773804, 'minatar-freeway/eval_R': 55.029998779296875, 'steps': 235929600}
{'sec': 82.62160444259644, 'minatar-freeway/eval_R': 55.90999984741211, 'steps': 238551040}
{'sec': 83.52865648269653, 'minatar-freeway/eval_R': 55.44999694824219, 'steps': 241172480}
{'sec': 84.4366443157196, 'minatar-freeway/eval_R': 55.47999954223633, 'steps': 243793920}
{'sec': 85.34457612037659, 'minatar-freeway/eval_R': 55.98999786376953, 'steps': 246415360}
{'sec': 86.25217700004578, 'minatar-freeway/eval_R': 56.099998474121094, 'steps': 249036800}
{'sec': 87.15962529182434, 'minatar-freeway/eval_R': 56.68000030517578, 'steps': 251658240}
{'sec': 88.06734442710876, 'minatar-freeway/eval_R': 55.7599983215332, 'steps': 254279680}
{'sec': 88.97485327720642, 'minatar-freeway/eval_R': 55.89999771118164, 'steps': 256901120}
{'sec': 89.88291120529175, 'minatar-freeway/eval_R': 56.47999954223633, 'steps': 259522560}
{'sec': 90.79120802879333, 'minatar-freeway/eval_R': 56.40999984741211, 'steps': 262144000}
{'sec': 91.69932723045349, 'minatar-freeway/eval_R': 56.75, 'steps': 264765440}
{'sec': 92.60667490959167, 'minatar-freeway/eval_R': 56.56999969482422, 'steps': 267386880}
{'sec': 93.51483678817749, 'minatar-freeway/eval_R': 56.81999969482422, 'steps': 270008320}
{'sec': 94.42223763465881, 'minatar-freeway/eval_R': 56.65999984741211, 'steps': 272629760}
{'sec': 95.32954573631287, 'minatar-freeway/eval_R': 56.91999816894531, 'steps': 275251200}
{'sec': 96.2370958328247, 'minatar-freeway/eval_R': 56.77000045776367, 'steps': 277872640}
{'sec': 97.14654159545898, 'minatar-freeway/eval_R': 56.59000015258789, 'steps': 280494080}
{'sec': 98.0541660785675, 'minatar-freeway/eval_R': 56.57999801635742, 'steps': 283115520}
{'sec': 98.960928440094, 'minatar-freeway/eval_R': 57.18000030517578, 'steps': 285736960}
{'sec': 99.8685553073883, 'minatar-freeway/eval_R': 56.939998626708984, 'steps': 288358400}
{'sec': 100.77513527870178, 'minatar-freeway/eval_R': 57.14999771118164, 'steps': 290979840}
{'sec': 101.68264317512512, 'minatar-freeway/eval_R': 57.28999710083008, 'steps': 293601280}
{'sec': 102.58990383148193, 'minatar-freeway/eval_R': 57.529998779296875, 'steps': 296222720}
{'sec': 103.4979190826416, 'minatar-freeway/eval_R': 57.369998931884766, 'steps': 298844160}
{'sec': 104.4052426815033, 'minatar-freeway/eval_R': 56.96999740600586, 'steps': 301465600}
{'sec': 105.31341791152954, 'minatar-freeway/eval_R': 57.77000045776367, 'steps': 304087040}
{'sec': 106.2210750579834, 'minatar-freeway/eval_R': 57.77000045776367, 'steps': 306708480}
{'sec': 107.1291298866272, 'minatar-freeway/eval_R': 57.28999710083008, 'steps': 309329920}
{'sec': 108.03836011886597, 'minatar-freeway/eval_R': 57.19999694824219, 'steps': 311951360}
{'sec': 108.94610905647278, 'minatar-freeway/eval_R': 57.77000045776367, 'steps': 314572800}
{'sec': 109.85462188720703, 'minatar-freeway/eval_R': 57.709999084472656, 'steps': 317194240}
{'sec': 110.76181960105896, 'minatar-freeway/eval_R': 57.63999938964844, 'steps': 319815680}
{'sec': 111.67088794708252, 'minatar-freeway/eval_R': 57.56999969482422, 'steps': 322437120}
{'sec': 112.57763481140137, 'minatar-freeway/eval_R': 57.47999954223633, 'steps': 325058560}
{'sec': 113.48471570014954, 'minatar-freeway/eval_R': 57.5, 'steps': 327680000}
{'sec': 114.39200854301453, 'minatar-freeway/eval_R': 57.80999755859375, 'steps': 330301440}
{'sec': 115.30023741722107, 'minatar-freeway/eval_R': 57.959999084472656, 'steps': 332922880}
{'sec': 116.20802164077759, 'minatar-freeway/eval_R': 58.12999725341797, 'steps': 335544320}
{'sec': 117.11542558670044, 'minatar-freeway/eval_R': 57.869998931884766, 'steps': 338165760}
{'sec': 118.02312326431274, 'minatar-freeway/eval_R': 57.91999816894531, 'steps': 340787200}
{'sec': 118.9306092262268, 'minatar-freeway/eval_R': 57.849998474121094, 'steps': 343408640}
{'sec': 119.83915424346924, 'minatar-freeway/eval_R': 58.27000045776367, 'steps': 346030080}
{'sec': 120.74724555015564, 'minatar-freeway/eval_R': 58.31999969482422, 'steps': 348651520}
{'sec': 121.65533709526062, 'minatar-freeway/eval_R': 58.22999954223633, 'steps': 351272960}
{'sec': 122.56322193145752, 'minatar-freeway/eval_R': 57.86000061035156, 'steps': 353894400}
{'sec': 123.47096157073975, 'minatar-freeway/eval_R': 58.53999710083008, 'steps': 356515840}
{'sec': 124.37802410125732, 'minatar-freeway/eval_R': 58.189998626708984, 'steps': 359137280}
{'sec': 125.28616786003113, 'minatar-freeway/eval_R': 58.37999725341797, 'steps': 361758720}
{'sec': 126.19429802894592, 'minatar-freeway/eval_R': 58.59000015258789, 'steps': 364380160}
{'sec': 127.10231876373291, 'minatar-freeway/eval_R': 58.30999755859375, 'steps': 367001600}
{'sec': 128.00957250595093, 'minatar-freeway/eval_R': 58.68000030517578, 'steps': 369623040}
{'sec': 128.91680788993835, 'minatar-freeway/eval_R': 58.189998626708984, 'steps': 372244480}
{'sec': 129.82452058792114, 'minatar-freeway/eval_R': 58.82999801635742, 'steps': 374865920}
{'sec': 130.73255395889282, 'minatar-freeway/eval_R': 58.69999694824219, 'steps': 377487360}
{'sec': 131.64133071899414, 'minatar-freeway/eval_R': 58.57999801635742, 'steps': 380108800}
{'sec': 132.54881072044373, 'minatar-freeway/eval_R': 58.56999969482422, 'steps': 382730240}
{'sec': 133.45666790008545, 'minatar-freeway/eval_R': 58.75, 'steps': 385351680}
{'sec': 134.36403465270996, 'minatar-freeway/eval_R': 58.80999755859375, 'steps': 387973120}
{'sec': 135.27173972129822, 'minatar-freeway/eval_R': 58.709999084472656, 'steps': 390594560}
{'sec': 136.17960691452026, 'minatar-freeway/eval_R': 58.77000045776367, 'steps': 393216000}
{'sec': 137.0878233909607, 'minatar-freeway/eval_R': 58.959999084472656, 'steps': 395837440}
{'sec': 137.99492025375366, 'minatar-freeway/eval_R': 59.1099967956543, 'steps': 398458880}
{'sec': 138.9016876220703, 'minatar-freeway/eval_R': 59.19999694824219, 'steps': 401080320}
{'sec': 139.8095600605011, 'minatar-freeway/eval_R': 58.98999786376953, 'steps': 403701760}
{'sec': 140.71687126159668, 'minatar-freeway/eval_R': 59.28999710083008, 'steps': 406323200}
{'sec': 141.62374687194824, 'minatar-freeway/eval_R': 59.23999786376953, 'steps': 408944640}
{'sec': 142.53148365020752, 'minatar-freeway/eval_R': 59.62999725341797, 'steps': 411566080}
{'sec': 143.43857645988464, 'minatar-freeway/eval_R': 58.88999938964844, 'steps': 414187520}
{'sec': 144.34597253799438, 'minatar-freeway/eval_R': 58.5099983215332, 'steps': 416808960}
{'sec': 145.25324845314026, 'minatar-freeway/eval_R': 59.23999786376953, 'steps': 419430400}
{'sec': 146.16174054145813, 'minatar-freeway/eval_R': 59.37999725341797, 'steps': 422051840}
{'sec': 147.06945705413818, 'minatar-freeway/eval_R': 59.46999740600586, 'steps': 424673280}
{'sec': 147.9767291545868, 'minatar-freeway/eval_R': 59.13999938964844, 'steps': 427294720}
{'sec': 148.88366675376892, 'minatar-freeway/eval_R': 59.0, 'steps': 429916160}
{'sec': 149.79051399230957, 'minatar-freeway/eval_R': 59.71999740600586, 'steps': 432537600}
{'sec': 150.69751167297363, 'minatar-freeway/eval_R': 59.59000015258789, 'steps': 435159040}
{'sec': 151.60517597198486, 'minatar-freeway/eval_R': 58.68000030517578, 'steps': 437780480}
{'sec': 152.5115089416504, 'minatar-freeway/eval_R': 59.12999725341797, 'steps': 440401920}
{'sec': 153.41928434371948, 'minatar-freeway/eval_R': 59.689998626708984, 'steps': 443023360}
{'sec': 154.32683515548706, 'minatar-freeway/eval_R': 59.29999923706055, 'steps': 445644800}
{'sec': 155.2339084148407, 'minatar-freeway/eval_R': 58.79999923706055, 'steps': 448266240}
{'sec': 156.14090132713318, 'minatar-freeway/eval_R': 59.44999694824219, 'steps': 450887680}
{'sec': 157.04841470718384, 'minatar-freeway/eval_R': 59.41999816894531, 'steps': 453509120}
{'sec': 157.95450258255005, 'minatar-freeway/eval_R': 59.69999694824219, 'steps': 456130560}
{'sec': 158.86278867721558, 'minatar-freeway/eval_R': 59.68000030517578, 'steps': 458752000}
{'sec': 159.8847427368164, 'minatar-freeway/eval_R': 59.87999725341797, 'steps': 461373440}
{'sec': 160.79200839996338, 'minatar-freeway/eval_R': 59.689998626708984, 'steps': 463994880}
{'sec': 161.69857716560364, 'minatar-freeway/eval_R': 59.15999984741211, 'steps': 466616320}
{'sec': 162.60768485069275, 'minatar-freeway/eval_R': 59.7599983215332, 'steps': 469237760}
{'sec': 163.5148422718048, 'minatar-freeway/eval_R': 59.57999801635742, 'steps': 471859200}
{'sec': 164.4229142665863, 'minatar-freeway/eval_R': 60.09000015258789, 'steps': 474480640}
{'sec': 165.3302083015442, 'minatar-freeway/eval_R': 59.44999694824219, 'steps': 477102080}
{'sec': 166.23631596565247, 'minatar-freeway/eval_R': 59.029998779296875, 'steps': 479723520}
{'sec': 167.14373350143433, 'minatar-freeway/eval_R': 58.98999786376953, 'steps': 482344960}
{'sec': 168.05095410346985, 'minatar-freeway/eval_R': 59.57999801635742, 'steps': 484966400}
{'sec': 168.95833683013916, 'minatar-freeway/eval_R': 59.2599983215332, 'steps': 487587840}
{'sec': 169.86551928520203, 'minatar-freeway/eval_R': 59.6099967956543, 'steps': 490209280}
{'sec': 170.77352619171143, 'minatar-freeway/eval_R': 59.79999923706055, 'steps': 492830720}
{'sec': 171.68001055717468, 'minatar-freeway/eval_R': 59.71999740600586, 'steps': 495452160}
{'sec': 172.5879476070404, 'minatar-freeway/eval_R': 60.32999801635742, 'steps': 498073600}
Model saved to ./minatar-ppo-autoregressive-models/minatar-freeway//minatar-freeway-autoregressive-fs=1-N=5.ckpt
Training complete!
